<!DOCTYPE html>
<html ng-app="AdminModule">
<head>

<title>Debiki — for the fruitful conversations</title>
<meta content="" name="description">
<meta content="" name="keywords">
<meta name="viewport" content="initial-scale=1.0, minimum-scale=0.01">
<meta charset="utf-8">

<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Bree+Serif">
<link rel="stylesheet" href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap.no-icons.min.css">
<link rel="stylesheet" href="http://www.debiki.com/www-debiki-com.css">
<link rel="stylesheet" href="/-/res/debiki-spa-common.css">
<link rel="stylesheet" href="/-/res/debiki-spa-admin.css">

<script src="http://cdnjs.cloudflare.com/ajax/libs/modernizr/2.5.3/modernizr.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.1/angular.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.1/angular-sanitize.min.js"></script>
<script>
  var debiki = { v0: { util: {} }, internal: { $: jQuery } };
  debiki.scriptLoad = $.Deferred();
  Modernizr.load({
    test: Modernizr.touch,
    yep: '/-/res/combined-debiki-touch.js',
    nope: '/-/res/combined-debiki-desktop.js'
  });
</script>
<script src="/-/res/debiki-spa-common.js"></script>
<!--<script src="/-/res/debiki-spa-admin-server-mock.js"></script>-->
<script src="/-/res/debiki-spa-admin.js"></script>

</head>
<body>
<div>
  <div dw-modal-dialog></div>

  <h1>Admin Page</h1>
  <div id='admin-container'>
    <div>
      <div id='details'>
        <ul class="nav nav-tabs">
          <li class='active'><a href="#pages-tab" data-toggle="tab">Contents</a></li>
          <li><a href="#events-tab" data-toggle="tab">Activity</a></li>
          <li><a href="#users-tab" data-toggle="tab">Users</a></li>
        </ul>

        <div class="tab-content">
          <div ng-controller='ActionListCtrl' class='tab-pane' id='events-tab'>
            <div class='selection-related-btns'>
              <!--<a id='btn-view-post' class='btn' ng-show='oneRowChecked'>View</a>-->
              <a id='btn-approve-post' class='btn' ng-show='manyRowsChecked'>Approve</a>
              <a id='btn-reject-post' class='btn' ng-show='manyRowsChecked'>Reject</a>
              <!-- <a class='btn'>Edit</a>
              <a class='btn'>Subscribe</a>
              <a class='btn'>!Spam</a>
              <a class='btn'>#Delete</a>
              <a class='btn'>Sort</a> -->
            </div>
            <p ng-show="!actionList.length">No activity thus far.</p>
            <table class='table -table-bordered -table-striped'
                 ng-show="actionList.length">
              <thead>
                <tr>
                  <th class='row-selector'><!-- dupl code! -->
                    <label>
                      <input type='checkbox' ng-change='toggleAllChecked()'
                      ng-model='allSelected'>
                    </label>
                  </th>
                  <th>Activity</th>
                  <th>Author</th>
                  <th>Date</th>
                  <th>Text</th>
                </tr>
              </thead>
              <tbody>
                <tr ng-repeat='action in actionList'>
                  <td class='row-selector'><!-- dupl code! -->
                    <label>
                      <input type='checkbox' ng-model='action.selected'
                          ng-click='onRowCheckedChange()'>
                    </label>
                  </td>
                  <td class='action-what'>
                    <div>
                      <a target='_blank' class='action-description' href='{{action.url}}'>{{action.description}}</a>
                      <a class='inline-action approve-action' ng-click='approve(action)' ng-show='action.approveBtnText'>{{action.approveBtnText}}</a>
                      <a class='inline-action reject-action' ng-click='reject(action)' ng-show='action.showRejectBtn'>Reject</a>
                      <a class='inline-action delete-action' ng-click='delete(action)' ng-show='action.showDeleteBtn'>Delete</a>
                      <span class='inline-message'>{{action.inlineMessage}}</span>
                    </div>
                    <a target='_blank' class='action-path' href='{{action.url}}'>{{action.pagePath}}</a>
                  </td>
                  <td><a target='_blank' href='#!/user/{{action.authorId}}'>{{action.authorDisplayName}}</a></td>
                  <td>{{action.cdati.replace('T', ' ')}}</td>
                  <td class='post-text'>{{action.text}}</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div ng-controller='PathsCtrl' class='tab-pane active' id='pages-tab'>

            <div id="help-welcome-create-blog" class="help-tips"
                ng-show="!pageStats.blogOrForumExists">
              <p>Welcome to your new website!</p>
              <p>Click <b>Create...</b> and then <b>New Blog</b> to create a new blog.</p>
            </div>

            <div id="help-create-blog-article" class="help-tips"
              ng-show="pageStats.blogExists && !pageStats.blogPostExists">
              <p>To create a blog article:</p>
              <ol>
                <li>Go to the blog main page — click on it, below.
                </li>
                <li>On the blog main page, click <b>Write new blog post</b>,
                  at the very top of the page.
                </li>
              </ol>
            </div>

            <div class='selection-related-btns'>

              <div id='create-page-dropdown' class='dropdown' ng-show='nothingSelected'>
                <a class='btn dropdown-toggle' data-toggle='dropdown' href='#'>Create ...</a>
                <ul class='dropdown-menu' role='menu' data-todo-aria-labelledby='drop5'>
                  <li><a tabindex='-1' ng-click='createDraftPage("InfoPage")' href='#'>New Info Page</a></li>
                  <li class='divider'></li>
                  <li><a tabindex='-1' ng-click='createBlog()' href='#'>New Blog</a></li>
                  <li><a tabindex='-1' disabled>New Forum</a></li>
                  <li><a tabindex='-1' disabled>New Wiki</a></li>
                  <li class='divider'></li>
                  <li><span>Advanced users:</span></li>
                  <li><a tabindex='-1' disabled>Script</a></li>
                  <li><a tabindex='-1' disabled>Style</a></li>
                  <li><a tabindex='-1' disabled>Template</a></li>
                </ul>
              </div>

              <a id='view-page-btn' class='btn' ng-click='viewSelectedPage()' ng-show='onePageSelected'>View / Edit</a>

              <div id='move-page-btn' class='dropdown'
                  ng-show='onePageSelected'>
                <a class='btn dropdown-toggle' id='move-page-dropdown-btn' data-toggle='dropdown' href='#' role='button'
                      ng-click='movePageForm.newFolder = selectedPage().folderPath()'>Move</a>
                  <form name='movePageForm' class='dropdown-menu' role='menu' aria-labelledby='move-page-dropdown-btn'
                      ng-submit='moveSelectedPageTo(movePageForm.newFolder)'>
                  <label>Move page to folder:
                    <input name='newFolderInput' type='text' required
                        ng-model='movePageForm.newFolder'
                        ng-pattern='patterns.folderPath'>
                  </label>
                  <p ng-show='movePageForm.newFolderInput.$error.pattern'>
                    Enter a value like: <i>/some/folder/</i>
                  </p>
                  <input type='submit' class='btn' value='Move page'
                      ng-disabled='movePageForm.$invalid'>
                </form>
              </div>

              <div id='rename-page-btn' class='dropdown'
                  ng-show='onePageSelected'>
                <a class='btn dropdown-toggle' id='rename-page-dropdown-btn' data-toggle='dropdown' href='#' role='button'
                      ng-click='renamePageForm.newSlug = selectedPage().slug()'>Rename</a>
                  <form name='renamePageForm' class='dropdown-menu' role='menu' aria-labelledby='rename-page-dropdown-btn'
                    ng-submit='renameSelectedPageTo({ newSlug: renamePageForm.newSlug, newTitle: renamePageForm.newTitle })'>

                  <!--
                  <label>Change page title to:
                    <input name='newTitleInput' type='text' xrequired
                        ng-model='renamePageForm.newTitle'
                        ng-pattern='patterns.pageTitle'>
                  </label>
                  <p ng-show='renamePageForm.newTitleInput.$error.pattern'>
                    Enter something like: <i>Some Page Title</i>
                  </p>
                  -->

                  <label>Change page slug to:
                    <input name='newSlugInput' type='text' xrequired
                        ng-model='renamePageForm.newSlug'
                        ng-pattern='patterns.pageSlug'>
                  </label>
                  <p ng-show='renamePageForm.newSlugInput.$error.pattern'>
                    Enter something like: <i>some-page-slug</i>
                  </p>

                  <input type='submit' class='btn' value='Rename'
                      ng-disabled='renamePageForm.$invalid'>
                </form>
              </div>

              <div id='use-as-homepage-btn' class='dropdown'
                  ng-show='onePageSelected && !homepageSelected'>
                <a class='btn dropdown-toggle' id='use-as-homepage-dropdown-btn' data-toggle='dropdown' href='#' role='button'>Use as Homepage</a>
                  <form name='useAsHomepageForm' class='dropdown-menu' role='menu' aria-labelledby='use-as-homepage-dropdown-btn'
                      ng-submit='changeHomepageToSelectedPage()'>
                    <p>Change homepage to <em>{{ anySelectedPageTitle() }}</em>?</p>
                    <!-- COULD clarify:
                    <p>The current homepage will be available here: (URL to previous page path to current homepage)</p>
                    -->
                    <input type='submit' class='btn' value='Yes, do it'>
                    <!--
                    Currently this actually *submits* the form, why??
                    <button class='btn'
                      ng-click='closeDropdown()'>Cancel</button>
                    -->
                </form>
              </div>

              <!--
              <a id='publish-page-btn' class='btn' ng-click='publishSelectedPages()' ng-show='onlyDraftsSelected'>Publish</a>
              <a id='publish-page-btn' class='btn' ng-click='unpublishSelectedPages()' ng-show='onlyPublishedSelected'>Unpublish</a>
              -->
            </div>

            <div id='page-tree-container'>
              <!-- This might be rather confusing, since currnetly
                  full page paths are shown nowhere.
              <label>Filter paths: <input ng-model="pathFilterText"/></label>
                -->

              <table id="page-table" class="table">
                <thead>
                  <tr>
                    <th class='row-selector'><!-- dupl code! -->
                      <!-- Why would one need to select all pages?
                      <label>
                        <input type='checkbox'
                            xxng-change='toggleAllChecked()'
                            xxng-model='allSelected'>
                      </label> -->
                    </th>
                    <th>Page Title</th>
                    <th><div ui-jq="tooltip" title="Influences how the page is rendered and what you can do with it.">Role</th>
                    <th><div ui-jq="tooltip" title="A menu lists links to pages on the website.">Menu</div></th>
                    <th>URL</th>
                    <th>Authors</th>
                    <th>Last modified</th>
                  </tr>
                </thead>
                <tbody>
                  <tr class="{{page.cssForRole()}}"
                      ng-repeat="page in listItems">
                    <td class='row-selector'><!-- dupl code! -->
                      <label>
                        <input type='checkbox'
                            ng-model='page.included'
                            xxng-click='onRowCheckedChange()'
                            ng-click='updateSelections()'>
                      </label>
                    </td>
                    <td class='page-title'>
                      <a href="{{ page.path }}" target="_blank" ng-bind-html="page.prettyTitle()"></a>
                      <span class="page-notfs">{{ page.stringifyOtherMarks() }}</span>
                    </td>
                    <td><div data-original-title="{{ page.prettyRoleTooltip() }}" ui-jq="tooltip">{{ page.prettyRole() }}</div></td>
                    <td><div data-original-title="{{ page.prettyMenuTooltip() }}" ui-jq="tooltip">{{ page.prettyMenu() }}</div></td>
                    <td>{{ page.prettyUrl() }}</td>
                    <td></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <div ng-controller='UserListCtrl' class='tab-pane' id='users-tab'>
            <p>Not yet implemented.</p>
            <!--
            <div>
              <a class='btn'>Contact</a>
              <a class='btn'>Subscribe</a>
              <a class='btn'>Rename</a>
              <a class='btn'>Block</a>
              <a class='btn'>Sort</a>
            </div>
            <table class='table'>
              <thead>
                <tr>
                  <th class='row-selector'>
                    <label>
                      <input type='checkbox' ng-change='toggleAllChecked()'
                      ng-model='allSelected'>
                    </label>
                  </th>
                  <th>Name</th>
                  <th>Roles</th>
                  <th>Action Count</th>
                  <th>Email</th>
                  <th>Location</th>
                  <th>IPs</th>
                  <th>First Login</th>
                  <th>Last Login</th>
                </tr>
              </thead>
              <tbody>
                <tr ng-repeat='user in userList'>
                  <td class='row-selector'>
                    <label>
                      <input type='checkbox' ng-model='user.selected'
                          ng-click='onRowCheckedChange()'>
                    </label>
                  </td>
                  <td><a target='_blank'>{{user.name}}</a></td>
                  <td><a target='_blank'>[todo]</a></td>
                  <td><a target='_blank'>[todo]</a></td>
                  <td><a target='_blank'>{{user.email || ''}}</a></td>
                  <td><a target='_blank'>{{user.country || user.location}}</a></td>
                  <td><a target='_blank'>[todo]</a></td>
                  <td><a target='_blank'>{{user.ctime.replace('T', ' ')}}</a></td>
                  <td><a target='_blank'>{{user.lastLoginTime.replace('T', ' ')}}</a></td>
                </tr>
              </tbody>
            </table>
            -->
          </div>
        </div>
      </div>
    </div>
  </div>

</div>
</body>
</html>
<!-- vim: fdm=marker et ts=2 sw=2 fo=tcqwn list tw=0
-->
